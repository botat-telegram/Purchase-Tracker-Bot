# 🛒 بوت تتبع المشتريات - Telegram Purchase Tracker Bot

بوت تيليجرام لتتبع المشتريات وإضافتها تلقائياً إلى Google Sheets.

## 🌟 المميزات الرئيسية

- ✅ إضافة منتجات مع الأسعار والملاحظات الاختيارية
- 📊 تخزين البيانات في Google Sheets
- 🔄 دعم إضافة منتجات متعددة في رسالة واحدة
- 🧠 تحليل ذكي للنصوص المعقدة باستخدام Google Gemini
- 📱 واجهة تفاعلية مع أزرار وقوائم
- 🔤 دعم كامل للغة العربية
- 🔢 دعم الأرقام العربية والهندية
- 💲 تحليل ذكي للعملات والمبالغ المالية
- 🌙 وضع تجريبي للاختبار بدون الاتصال بـ Google Sheets

## 📋 متطلبات التشغيل

- Python 3.8+
- توكن بوت تيليجرام (من [@BotFather](https://t.me/BotFather))
- حساب Google Cloud (لاستخدام Google Sheets API)
- اختياري: مفتاح Google Gemini API (للتحليل الذكي للنصوص)

## ⚙️ الإعداد

### 1. استنساخ المشروع

```bash
git clone https://github.com/yourusername/purchase-tracker-bot.git
cd purchase-tracker-bot
```

### 2. إنشاء بيئة افتراضية وتثبيت المتطلبات

```bash
python -m venv venv
source venv/bin/activate  # لينكس/ماك
venv\Scripts\activate     # ويندوز

pip install -r requirements.txt
```

### 3. إعداد ملف .env

أنشئ ملف `.env` في المجلد الرئيسي ويحتوي على:

```
TELEGRAM_TOKEN=your_telegram_bot_token
GOOGLE_SHEETS_KEY=your_google_sheets_id  # اختياري
GEMINI_API_KEY=your_gemini_api_key       # اختياري
```

### 4. إعداد حساب Google Cloud وGoogle Sheets

1. أنشئ مشروعًا في [Google Cloud Console](https://console.cloud.google.com/)
2. فعّل Google Sheets API و Google Drive API
3. أنشئ حساب خدمة واحصل على مفتاح JSON
4. حمّل ملف مفتاح الخدمة وضعه في المجلد الرئيسي باسم `sheet-bot-444713-d558e2ce2ee8.json`
5. أنشئ جدول بيانات Google Sheets جديد واجعله قابل للمشاركة مع حساب الخدمة (البريد الإلكتروني الموجود في ملف JSON)

## 🚀 تشغيل البوت

```bash
python run.py
```

## 💬 استخدام البوت

### أوامر البوت

- `/start` - بدء محادثة جديدة
- `/help` - عرض المساعدة
- `/cancel` - إلغاء العملية الحالية
- `/s` - تخطي الملاحظات
- `/last` - عرض آخر المنتجات المضافة

### طرق إضافة المنتجات

يمكن إضافة المنتجات بعدة طرق:

#### 1. منتج واحد (بسيط)

```
كولا 23
```

#### 2. منتج واحد (مع ملاحظة)

```
شيبس 25 حار 🌶
```

#### 3. عدة منتجات معًا

```
كولا 23
شيبس 25 حار
قهوة 15 اسبريسو
```

#### 4. أنماط مرنة

- دعم السعر أولاً: `25 كولا`
- دعم العملات: `كولا 23 ريال`
- دعم الأرقام العربية: `كولا ٢٣`
- دعم الكلمات: `كولا عشرين ريال`

## 🧩 بنية المشروع

```
purchase-tracker-bot/
├── run.py                # نقطة البداية
├── requirements.txt      # متطلبات المشروع
├── .env                  # متغيرات البيئة
├── src/
│   └── config.py         # إعدادات المشروع
├── handlers/
│   ├── commands.py       # معالجات الأوامر
│   ├── conversation.py   # معالجات المحادثة
│   └── gemini_integration.py # تكامل Google Gemini
├── database/
│   └── sheets.py         # التعامل مع Google Sheets
├── utils/
│   ├── number_converter.py # تحويل الأرقام العربية
│   └── gemini.py         # واجهة Google Gemini
└── logs/                 # سجلات البوت
```

## 🔍 التحسينات

- ✔️ استخدام Gemini API لتحليل النصوص المعقدة
- ✔️ واجهة مستخدم تفاعلية مع أزرار
- ✔️ دعم متقدم للأرقام العربية والهندية
- ✔️ دعم للتنسيقات المختلفة للعملات
- ✔️ إعادة المحاولة في حال فشل الاتصال
- ✔️ وضع تجريبي للعمل بدون اتصال بالإنترنت

## 📝 التطويرات المستقبلية

- [ ] إضافة خيار لتعديل آخر المنتجات المضافة
- [ ] إضافة دعم لفئات المنتجات
- [ ] إضافة تقارير وإحصاءات شهرية
- [ ] إضافة التذكيرات للمشتريات المتكررة
- [ ] دعم متعدد اللغات

## 🤝 المساهمة

الإسهامات مرحب بها! يمكنك:

1. تحديد المشكلات (Issues)
2. اقتراح ميزات جديدة
3. إرسال طلبات السحب (Pull Requests)

## 📄 الترخيص

هذا المشروع مرخص تحت [MIT License](LICENSE).
